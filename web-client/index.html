<!DOCTYPE HTML>
<html lang='en'>
<head>
   <meta http-equiv='Content-Type' content='text/html; charset=utf-8' >
   <meta name='format-detection' content='telephone=no'>

<script type="text/javascript">
/*
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31280404-1']);
  _gaq.push(['_setDomainName', 'fjutur.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

function trackEvent(category, action){
  _gaq.push(['_trackEvent', 'Videos', 'Play', 'Gone With the Wind']);
}
*/
</script>

   <title>cross copy</title>
   
            <link rel='stylesheet' href='styles.css' type='text/css' />
            <script src='jquery-ui/js/jquery-1.7.1.min.js' type='text/javascript'></script>
            <script src='jquery-ui/js/jquery-ui-1.8.18.custom.min.js' type='text/javascript'></script>
            <script src='jquery-ui/js/jquery.ui.touch-punch.js' type='text/javascript'></script>

            <script type="text/javascript">


var server = "http://localhost:8124/api";

var request;

function listen(secret){
  if (request != undefined)
    request.abort();

  if (secret.length == 0)
    return;
  
  request = $.get(server + '/' + secret, function(response) {
    setTimeout('listen()', 0);
    $('#received').append($('<li>' + response + '</li>'));
  });
}

$(document).ready(function() {

  $('#secret').keyup(function (e){
    listen($(this).val());
  });

  $('#data').keyup(function (e){
  
    if (e.which != 13)
      return;

    if (secret.length == 0)
      return;    

    console.log("what: " + $(this).val());
    $.ajax({
	      url: server + '/' + $('#secret').val(),
	      type: 'PUT',
        processData: false,
        crossDomain: false,
	      data: $('#data').val(),
        dataType: "text",
        success: function(response){
          console.log(response);
	      },
	      error: function(xhr, status){
		      console.log(status);
	      }
	 });

  });
  
});

</script>

</head>

<body>
  <div id="wrapper">
    <h1>cross copy</h1>

    <input name="secret" id="secret" type="text" size="30" placeholder="choose common secret">

    <input name="data" id="data" type="text" size="30" placeholder="your data">
    
    <ul id="received"></ul>
  </div>
</body>
</html>


<!DOCTYPE HTML>
<html lang='en'>
<head>
   <meta http-equiv='Content-Type' content='text/html; charset=utf-8' >
   <meta name='format-detection' content='telephone=no'>

<script type="text/javascript">
/*
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-31280404-1']);
  _gaq.push(['_setDomainName', 'fjutur.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

function trackEvent(category, action){
  _gaq.push(['_trackEvent', category, action]);
}
*/
</script>

   <title>cross copy</title>
   
            <link rel='stylesheet' href='styles.css' type='text/css' />
            <script src='jquery-1.7.1.min.js' type='text/javascript'></script>
            
            <script type="text/javascript">


var server = "http://localhost:8124/api";

var request;

function listen(){
  var secret = $('#secret').val();  

  if (request != undefined)
    request.abort();

  if (secret === undefined || secret.length == 0)
    return;
  
  request = $.get(server + '/' + secret, function(response) {
    $('#received').prepend($('<li>' + response + '</li>'));
    setTimeout('listen()', 10);
  });
}

$(document).ready(function() {

  $('#secret').keyup(function (e){
    listen();
  });

  $('#data').keyup(function (e){
  
    if (e.which != 13)
      return;

    if (secret.length == 0)
      return;    

    request.abort();
    $.ajax({
	      url: server + '/' + $('#secret').val(),
	      type: 'PUT',
        processData: false,
        crossDomain: false,
	      data: $('#data').val(),
        dataType: "text",
        success: function(response){
          console.log(response);
	      },
	      error: function(xhr, status){
		      console.log(status);
	      },
	      complete: function(xhr, status){
		      listen();
	      }
	 });

  });
  
});

</script>

</head>

<body>
  <div id="wrapper">
    <h1>cross copy</h1>

    <div class="step">
      <h2><span class="num">#1</span> open this page on different devices</h2>
    </div>

    <div class="step">
      <h2><span class="num">#2</span> choose common secret</h2>
      <input name="secret" id="secret" type="text" size="30" placeholder="">
    </div>

    <div class="step">
      <h2><span class="num">#3</span> enter text and press return</h2>
    <input name="data" id="data" type="text" size="30" placeholder="">
    </div>

    <div class="step">
      <h2><span class="num">#4</span> see cross copied text</h2>
      <ul id="received"></ul>
    </div>
  </div>
</body>
</html>

